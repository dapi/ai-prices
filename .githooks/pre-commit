#!/bin/bash

# Pre-commit hook –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è providers.csv –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ models.csv

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∏–∑–º–µ–Ω—ë–Ω models.csv
if git diff --cached --name-only | grep -q "^models.csv$"; then
    echo "üìù –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ models.csv"
    echo "üîÑ –ó–∞–ø—É—Å–∫–∞—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ providers.csv..."

    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    python3 scripts/update_providers.py

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª—Å—è –ª–∏ providers.csv
    if git diff --name-only | grep -q "^providers.csv$"; then
        echo "‚úÖ providers.csv –æ–±–Ω–æ–≤–ª—ë–Ω"
        # –î–æ–±–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ –∫–æ–º–º–∏—Ç
        git add providers.csv
        echo "üì¶ providers.csv –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–º–º–∏—Ç"
    else
        echo "‚ÑπÔ∏è  providers.csv –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è"
    fi
fi

exit 0
